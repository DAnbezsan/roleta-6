<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard - Roleta Premiada</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f4f4f4;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h2 {
    margin-top: 30px;
    color: #333;
  }
  .container {
    background: #fff;
    padding: 20px;
    margin-top: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    text-align: center;
    width: 90%;
    max-width: 400px;
  }
  button {
    background: #007bff;
    color: white;
    border: none;
    padding: 12px 24px;
    margin: 10px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
  }
  button:hover {
    background: #0056b3;
  }
  .hidden {
    display: none;
  }
  input[type="password"] {
    padding: 10px;
    width: 80%;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 8px;
  }
</style>
</head>
<body>
  <h2>Painel Administrativo</h2>

  <div id="loginSection" class="container">
    <p>Digite a senha para acessar:</p>
    <input type="password" id="passwordInput" placeholder="Senha de acesso">
    <br><br>
    <button id="loginBtn">Entrar</button>
  </div>

  <div id="dashboard" class="container hidden">
    <h3>Controle da Roleta</h3>
    <button id="resetBtn">Resetar dados</button>
    <button id="openSheetBtn">Abrir Planilha</button>
    <button id="openRoletaBtn">Abrir Roleta</button>
    <p id="statusMsg" style="margin-top:10px;color:#333;font-weight:bold;"></p>
  </div>

  <script>
  const CORRECT_PASSWORD = "adm0832";
  const SHEET_URL = "https://docs.google.com/spreadsheets/d/1OAQIPaTq8wXMo_o3snjMRwA2P1FN5Z1ecjTFPIghQLM/edit?gid=0#gid=0";
  const RESET_API_URL = "https://script.google.com/macros/s/AKfycbyuGuYoXBLcddHP9D6Y-ZLotbp8-PhP-nu_B7-rCEHLsty1zyH8PMnzicGMO6ZAYBjQ/exec?action=reset";

  const loginSection = document.getElementById("loginSection");
  const dashboard = document.getElementById("dashboard");
  const statusMsg = document.getElementById("statusMsg");

  document.getElementById("loginBtn").addEventListener("click", () => {
    const input = document.getElementById("passwordInput").value.trim();
    if (input === CORRECT_PASSWORD) {
      loginSection.classList.add("hidden");
      dashboard.classList.remove("hidden");
    } else {
      alert("Senha incorreta!");
    }
  });

  document.getElementById("resetBtn").addEventListener("click", async () => {
    if (!confirm("Tem certeza que deseja resetar todos os dados e a planilha?")) return;

    // Limpa dados locais da roleta
    localStorage.removeItem("wheelHasSpun");
    localStorage.removeItem("usedPhones");
    localStorage.removeItem("wheelPhone");
    statusMsg.textContent = "Dados locais resetados...";

    // Chama o Apps Script para limpar a planilha
    try {
      const res = await fetch(RESET_API_URL);
      if (res.ok) {
        statusMsg.textContent = "✅ Planilha e dados locais resetados com sucesso!";
      } else {
        statusMsg.textContent = "⚠️ Erro ao tentar resetar a planilha (verifique o Apps Script).";
      }
    } catch (e) {
      statusMsg.textContent = "❌ Falha ao conectar com o servidor do Google Apps Script.";
    }
  });

  document.getElementById("openSheetBtn").addEventListener("click", () => {
    window.open(SHEET_URL, "_blank");
  });

  document.getElementById("openRoletaBtn").addEventListener("click", () => {
    window.open("index.html", "_blank");
  });
  </script>
</body>
</html>
