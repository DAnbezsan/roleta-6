<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roleta Premiada Simples</title>

<style>
body {
  font-family: Arial, sans-serif;
  text-align: center;
  background: #f7f7f7;
  margin: 0; padding: 20px;
}

#wheel {
  width: 320px;
  height: 320px;
  border-radius: 50%;
  border: 6px solid #444;
  margin: 20px auto;
  background: white;
}

#spin {
  padding: 12px 30px;
  font-size: 18px;
  background: #28a745;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

#spin:disabled {
  background: #bbb;
  cursor: not-allowed;
}

.arrow {
  width: 0;
  height: 0;
  border-left: 15px solid transparent;
  border-right: 15px solid transparent;
  border-bottom: 25px solid red;
  margin: auto;
}

.modal {
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.5);
  justify-content:center;
  align-items:center;
}

.modal-content {
  background:#fff;
  padding:20px;
  width:80%;
  max-width:380px;
  border-radius:8px;
}
</style>

</head>
<body>

<h2>ðŸŽ¯ Roleta Premiada</h2>

<div class="arrow"></div>
<canvas id="wheel"></canvas>
<button id="spin">Girar</button>

<!-- Modal Telefone -->
<div id="phoneModal" class="modal">
  <div class="modal-content">
    <h3>Digite seu telefone:</h3>
    <input id="phone" placeholder="DDD + nÃºmero" style="width:95%;padding:8px">
    <br><br>
    <button onclick="savePhone()">Salvar</button>
    <button onclick="closePhone()">Cancelar</button>
  </div>
</div>

<!-- Modal Resultado -->
<div id="resultModal" class="modal">
  <div class="modal-content">
    <h3 id="resultText"></h3>
    <button id="whatsappBtn">Enviar via WhatsApp</button>
    <br><br>
    <button onclick="closeResult()">Fechar</button>
  </div>
</div>

<script>
// CONFIG
const GOOGLE_SCRIPT_URL = ""; // coloque sua Web App URL
const OWNER_WHATSAPP = "5577981633924";
const ADMIN_PHONE = "5577998652620";

// PrÃªmios
const prizes = [
 "DESIGN 50%", "FIO A FIO 50%", "SHADOW 50%",
 "DESIGN 100%", "FIO A FIO 100%", "SHADOW 100%"
];

const colors = ["#ffb703","#8ecae6","#fb8500","#219ebc","#90be6d","#ff006e"];

let used = JSON.parse(localStorage.getItem("usedPhones") || "[]");
let wheel = document.getElementById("wheel");
let ctx = wheel.getContext("2d");
let currentAngle = 0;
let savedPhone = localStorage.getItem("phone") || "";

// desenhar roleta
function drawWheel(){
  let angle = (2 * Math.PI) / prizes.length;
  for(let i=0;i<prizes.length;i++){
    ctx.beginPath();
    ctx.moveTo(160,160);
    ctx.fillStyle = colors[i];
    ctx.arc(160,160,160,i*angle,(i+1)*angle);
    ctx.fill();
    ctx.save();
    ctx.translate(160,160);
    ctx.rotate(i*angle + angle/2);
    ctx.fillStyle = "#000";
    ctx.font = "bold 14px Arial";
    ctx.fillText(prizes[i], 50, 5);
    ctx.restore();
  }
}
drawWheel();

document.getElementById("spin").onclick = ()=> {
  if(!savedPhone){ openPhone(); return; }

  if(savedPhone !== ADMIN_PHONE && used.includes(savedPhone)){
    alert("Esse nÃºmero jÃ¡ participou!");
    return;
  }

  spinWheel();
};

function spinWheel() {
  let finalAngle = Math.random()*360 + 720;
  let step = 5;

  let interval = setInterval(()=>{
    currentAngle += step;
    wheel.style.transform = `rotate(${currentAngle}deg)`;
    if(currentAngle >= finalAngle){
      clearInterval(interval);
      let prizeIndex = Math.floor(((360 - (currentAngle % 360)) / (360/prizes.length))) % prizes.length;
      let prize = prizes[prizeIndex];
      showResult(prize);

      if(savedPhone !== ADMIN_PHONE){
        used.push(savedPhone);
        localStorage.setItem("usedPhones",JSON.stringify(used));
      }

    }
  },10);
}

function openPhone(){ document.getElementById("phoneModal").style.display="flex"; }
function closePhone(){ document.getElementById("phoneModal").style.display="none"; }

function savePhone(){
  let p = document.getElementById("phone").value.replace(/\D/g,"");
  if(p.length < 10){ alert("Telefone invÃ¡lido"); return; }
  savedPhone = p;
  localStorage.setItem("phone",p);
  closePhone();
}

function showResult(prize){
  document.getElementById("resultText").innerText = "ðŸŽ‰ VocÃª ganhou: " + prize;
  document.getElementById("resultModal").style.display = "flex";

  document.getElementById("whatsappBtn").onclick = () => {
    let msg = `Ganhei na roleta!\nPrÃªmio: ${prize}\nTelefone: ${savedPhone}`;
    window.open(`https://wa.me/${OWNER_WHATSAPP}?text=${encodeURIComponent(msg)}`);
  };
}

function closeResult(){ document.getElementById("resultModal").style.display="none"; }
</script>
</body>
</html>
